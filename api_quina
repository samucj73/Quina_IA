import requests
import time

# URLs
LATEST_URL = "https://loteriascaixa-api.herokuapp.com/api/quina/latest"
BASE_URL = "https://loteriascaixa-api.herokuapp.com/api/quina/{}"

def get_latest_concurso():
    try:
        response = requests.get(LATEST_URL)
        if response.status_code == 200:
            return response.json()["concurso"]
    except Exception as e:
        print(f"Erro ao obter o √∫ltimo concurso: {e}")
    return None

def fetch_concurso(numero):
    url = BASE_URL.format(numero)
    try:
        response = requests.get(url)
        if response.status_code == 200:
            return response.json()
    except:
        pass
    return None

# Lista para armazenar todos os concursos
concursos_quina = []

def carregar_todos_concursos():
    ultimo = get_latest_concurso()
    if not ultimo:
        print("Erro ao buscar o √∫ltimo concurso.")
        return

    print(f"üîÑ Baixando concursos de 1 at√© {ultimo}...")

    for numero in range(1, ultimo + 1):
        dados = fetch_concurso(numero)
        if dados:
            concursos_quina.append(dados)
            print(f"‚úÖ Concurso {numero} capturado.")
        else:
            print(f"‚ùå Concurso {numero} falhou ou n√£o existe.")
        time.sleep(0.2)  # respeita o servidor

    print(f"‚úîÔ∏è {len(concursos_quina)} concursos carregados na vari√°vel `concursos_quina`.")

# Chama a fun√ß√£o principal
carregar_todos_concursos()

# Agora a vari√°vel concursos_quina cont√©m todos os dados
